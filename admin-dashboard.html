<!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ‘¥</div>
                <div class="stat-number" id="totalBookings">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ˜”</div>
                <div class="stat-number" id="totalExcuses">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">â­</div>
                <div class="stat-number" id="availableSlots">400</div>
                <div class="stat-label">Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªØ§Ø­Ø©</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-number" id="occupancyRate">0%</div>
                <div class="stat-label">Ù†Ø³Ø¨<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ø¬ØªÙ…Ø§Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± - Ø®Ø§Ù„Ø¯ Ø³Ø¹ÙˆØ¯ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0d5c0d, #1a7a1a, #2d8f2d);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #0d5c0d, #1a7a1a);
            color: white;
            padding: 30px;
            border-radius: 20px 20px 0 0;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        }
        
        .admin-title {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .admin-subtitle {
            font-size: 18px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .admin-info {
            font-size: 20px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid rgba(255,255,255,0.3);
            position: relative;
            z-index: 1;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(45, 143, 45, 0.05), transparent);
            transition: left 0.6s;
        }
        
        .stat-card:hover::before {
            left: 100%;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 15px;
            background: linear-gradient(135deg, #2d8f2d, #0d5c0d);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .stat-number {
            font-size: 36px;
            font-weight: bold;
            color: #0d5c0d;
            margin-bottom: 8px;
        }
        
        .stat-label {
            font-size: 16px;
            color: #666;
            font-weight: 500;
        }
        
        .controls-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .controls-title {
            font-size: 24px;
            color: #0d5c0d;
            font-weight: bold;
            margin-bottom: 25px;
            text-align: center;
            border-bottom: 3px solid #0d5c0d;
            padding-bottom: 10px;
        }
        
        .control-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .control-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .control-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.4s ease;
        }
        
        .control-btn:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #2d8f2d, #0d5c0d);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: #000;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .days-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .day-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .day-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #0d5c0d;
        }
        
        .day-name {
            font-size: 22px;
            font-weight: bold;
            color: #0d5c0d;
            margin-bottom: 5px;
        }
        
        .day-date {
            font-size: 16px;
            color: #666;
        }
        
        .day-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .booked-count {
            font-size: 18px;
            font-weight: bold;
            color: #2d8f2d;
        }
        
        .available-count {
            font-size: 16px;
            color: #666;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            border-radius: 5px;
            transition: width 0.8s ease;
        }
        
        .progress-fill.full {
            background: linear-gradient(90deg, #dc3545, #c82333);
        }
        
        .bookings-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 10px;
        }
        
        .booking-item {
            padding: 8px 12px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .booking-item:last-child {
            margin-bottom: 0;
        }
        
        .student-info {
            font-weight: 600;
            color: #0d5c0d;
        }
        
        .parent-info {
            color: #666;
            font-size: 13px;
        }
        
        .phone-info {
            color: #17a2b8;
            font-size: 12px;
            direction: ltr;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #0d5c0d;
        }
        
        .modal-title {
            font-size: 28px;
            color: #0d5c0d;
            font-weight: bold;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: #dc3545;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .close-btn:hover {
            background: #c82333;
            transform: scale(1.1);
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .report-table th,
        .report-table td {
            padding: 12px 15px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        .report-table th {
            background: linear-gradient(135deg, #0d5c0d, #2d8f2d);
            color: white;
            font-weight: bold;
        }
        
        .report-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .report-table tr:hover {
            background: #e9ecef;
        }
        
        .summary-section {
            background: #e9ecef;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .summary-title {
            font-size: 20px;
            color: #0d5c0d;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            text-align: center;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .summary-number {
            font-size: 24px;
            font-weight: bold;
            color: #0d5c0d;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 14px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .dashboard-container {
                margin: 10px;
                padding: 0 10px;
            }
            
            .admin-title {
                font-size: 28px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .control-buttons {
                grid-template-columns: 1fr;
            }
            
            .days-overview {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                height: 95%;
                max-width: none;
                max-height: none;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <h1 class="admin-title">ğŸ¯ Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ø¬ØªÙ…Ø§Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</h1>
            <p class="admin-subtitle">Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ - Ù…ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹ÙˆØ§Ù„ÙŠ</p>
            <div class="admin-info">ğŸ‘¨â€ğŸ’¼ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: Ø®Ø§Ù„Ø¯ Ø³Ø¹ÙˆØ¯ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</div>
        </div>
        
        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ‘¥</div>
                <div class="stat-number" id="totalBookings">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ˜”</div>
                <div class="stat-number" id="totalExcuses">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">â­</div>
                <div class="stat-number" id="availableSlots">400</div>
                <div class="stat-label">Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªØ§Ø­Ø©</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-number" id="occupancyRate">0%</div>
                <div class="stat-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ø´ØºØ§Ù„</div>
            </div>
        </div>
        
        <!-- Control Panel -->
        <div class="controls-section">
            <h2 class="controls-title">ğŸ› ï¸ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
            <div class="control-buttons">
                <button class="control-btn btn-primary" onclick="showDetailedReport()">
                    ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„
                </button>
                <button class="control-btn btn-secondary" onclick="exportToExcel()">
                    ğŸ“¤ ØªØµØ¯ÙŠØ± Excel
                </button>
                <button class="control-btn btn-warning" onclick="printReport()">
                    ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                </button>
                <button class="control-btn btn-danger" onclick="resetAllData()">
                    ğŸ—‘ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                </button>
            </div>
        </div>
        
        <!-- Days Overview -->
        <div class="days-overview" id="daysOverview">
            <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
        </div>
    </div>
    
    <!-- Modal for Detailed Report -->
    <div class="modal" id="reportModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <div class="modal-header">
                <h2 class="modal-title">ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙØµÙ„</h2>
            </div>
            <div id="modalContent">
                <!-- Ø³ÙŠØªÙ… Ø¥Ø¯Ø±Ø§Ø¬ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù‡Ù†Ø§ -->
            </div>
        </div>
    </div>
    
    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙŠØ§Ù…
        const DAYS_DATA = {
            sunday: { name: 'Ø§Ù„Ø£Ø­Ø¯', date: '15/3/1447Ù‡Ù€', max: 80 },
            monday: { name: 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†', date: '16/3/1447Ù‡Ù€', max: 80 },
            tuesday: { name: 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', date: '17/3/1447Ù‡Ù€', max: 80 },
            wednesday: { name: 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', date: '18/3/1447Ù‡Ù€', max: 80 },
            thursday: { name: 'Ø§Ù„Ø®Ù…ÙŠØ³', date: '19/3/1447Ù‡Ù€', max: 80 }
        };
        
        // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        let bookingsData = JSON.parse(localStorage.getItem('parentMeetingBookings') || '{}');
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStatistics() {
            let totalBookings = 0;
            let totalCapacity = 0;
            let totalExcuses = 0;
            
            for (const dayKey in DAYS_DATA) {
                const dayBookings = bookingsData[dayKey] || [];
                totalBookings += dayBookings.length;
                totalCapacity += DAYS_DATA[dayKey].max;
            }
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª
            totalExcuses = bookingsData.excuses ? bookingsData.excuses.length : 0;
            
            const availableSlots = totalCapacity - totalBookings;
            const occupancyRate = totalCapacity > 0 ? Math.round((totalBookings / totalCapacity) * 100) : 0;
            
            document.getElementById('totalBookings').textContent = totalBookings;
            document.getElementById('totalExcuses').textContent = totalExcuses;
            document.getElementById('availableSlots').textContent = availableSlots;
            document.getElementById('occupancyRate').textContent = occupancyRate + '%';
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙŠØ§Ù…
        function createDaysOverview() {
            const container = document.getElementById('daysOverview');
            container.innerHTML = '';
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                const bookedCount = bookings.length;
                const availableCount = dayInfo.max - bookedCount;
                const progressPercent = Math.round((bookedCount / dayInfo.max) * 100);
                
                const dayCard = document.createElement('div');
                dayCard.className = 'day-card';
                dayCard.innerHTML = `
                    <div class="day-header">
                        <div class="day-name">${dayInfo.name}</div>
                        <div class="day-date">${dayInfo.date}</div>
                    </div>
                    
                    <div class="day-stats">
                        <div class="booked-count">Ø§Ù„Ù…Ø­Ø¬ÙˆØ²: ${bookedCount}</div>
                        <div class="available-count">Ø§Ù„Ù…ØªØ§Ø­: ${availableCount}</div>
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill ${progressPercent >= 100 ? 'full' : ''}" 
                             style="width: ${progressPercent}%"></div>
                    </div>
                    
                    <div class="bookings-list">
                        ${bookings.length > 0 ? 
                            bookings.map((booking, index) => `
                                <div class="booking-item">
                                    <div>
                                        <div class="student-info">${index + 1}. ${booking.studentName}</div>
                                        <div class="parent-info">ğŸ‘¨â€ğŸ’¼ ${booking.parentName}</div>
                                        <div class="phone-info">ğŸ“± ${booking.phoneNumber}</div>
                                    </div>
                                </div>
                            `).join('') :
                            '<div style="text-align: center; color: #999; font-style: italic; padding: 20px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª</div>'
                        }
                    </div>
                `;
                
                container.appendChild(dayCard);
            }
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙØµÙ„
        function showDetailedReport() {
            const totalExcuses = bookingsData.excuses ? bookingsData.excuses.length : 0;
            
            let reportHTML = `
                <div class="summary-section">
                    <h3 class="summary-title">ğŸ“ˆ Ù…Ù„Ø®Øµ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3>
                    <div class="summary-stats">
                        <div class="summary-item">
                            <div class="summary-number">${getTotalBookings()}</div>
                            <div class="summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${totalExcuses}</div>
                            <div class="summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${getTotalAvailable()}</div>
                            <div class="summary-label">Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªØ§Ø­Ø©</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${getOccupancyRate()}%</div>
                            <div class="summary-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ø´ØºØ§Ù„</div>
                        </div>
                    </div>
                </div>
            `;
            
            reportHTML += `
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>Ø§Ù„ÙŠÙˆÙ…</th>
                            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                            <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</th>
                            <th>Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªØ§Ø­Ø©</th>
                            <th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ø´ØºØ§Ù„</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                const bookedCount = bookings.length;
                const availableCount = dayInfo.max - bookedCount;
                const dayOccupancy = Math.round((bookedCount / dayInfo.max) * 100);
                
                reportHTML += `
                    <tr>
                        <td><strong>${dayInfo.name}</strong></td>
                        <td>${dayInfo.date}</td>
                        <td>${bookedCount}/${dayInfo.max}</td>
                        <td>${availableCount}</td>
                        <td style="color: ${dayOccupancy >= 100 ? '#dc3545' : '#28a745'}">${dayOccupancy}%</td>
                    </tr>
                `;
            }
            
            reportHTML += '</tbody></table>';
            
            // Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª
            if (totalExcuses > 0) {
                reportHTML += `
                    <div style="margin: 30px 0; padding: 25px; background: #fff3cd; border-radius: 15px; border: 2px solid #ffc107;">
                        <h3 style="color: #856404; margin-bottom: 20px; text-align: center;">
                            ğŸ˜” Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª (${totalExcuses})
                        </h3>
                        <table class="report-table" style="font-size: 14px;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #ffc107, #e0a800); color: #000;">
                                    <th>#</th>
                                    <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                    <th>Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</th>
                                    <th>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</th>
                                    <th>Ø³Ø¨Ø¨ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±</th>
                                    <th>ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                bookingsData.excuses.forEach((excuse, index) => {
                    reportHTML += `
                        <tr style="background: ${index % 2 === 0 ? '#fff3cd' : 'white'};">
                            <td>${index + 1}</td>
                            <td><strong>${excuse.studentName}</strong></td>
                            <td>${excuse.parentName}</td>
                            <td style="direction: ltr;">${excuse.phoneNumber}</td>
                            <td style="max-width: 200px; word-wrap: break-word; font-size: 13px;">${excuse.excuseReason}</td>
                            <td style="font-size: 12px;">${excuse.timestamp}</td>
                        </tr>
                    `;
                });
                
                reportHTML += '</tbody></table></div>';
            }
            
            // Ø¥Ø¶Ø§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ù„ÙƒÙ„ ÙŠÙˆÙ…
            reportHTML += '<h3 style="margin-top: 30px; color: #0d5c0d;">ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h3>';
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                
                reportHTML += `
                    <div style="margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                        <h4 style="color: #0d5c0d; margin-bottom: 15px;">
                            ${dayInfo.name} - ${dayInfo.date} (${bookings.length}/${dayInfo.max})
                        </h4>
                `;
                
                if (bookings.length > 0) {
                    reportHTML += `
                        <table class="report-table" style="font-size: 14px;">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                    <th>Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</th>
                                    <th>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</th>
                                    <th>ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    bookings.forEach((booking, index) => {
                        reportHTML += `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${booking.studentName}</td>
                                <td>${booking.parentName}</td>
                                <td style="direction: ltr;">${booking.phoneNumber}</td>
                                <td style="font-size: 12px;">${booking.timestamp}</td>
                            </tr>
                        `;
                    });
                    
                    reportHTML += '</tbody></table>';
                } else {
                    reportHTML += '<p style="text-align: center; color: #999; font-style: italic;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…</p>';
                }
                
                reportHTML += '</div>';
            }
            
            document.getElementById('modalContent').innerHTML = reportHTML;
            document.getElementById('reportModal').style.display = 'block';
        }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        function closeModal() {
            document.getElementById('reportModal').style.display = 'none';
        }
        
        // ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel
        function exportToExcel() {
            let csvContent = "Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†,Ø§Ù„ÙŠÙˆÙ…,Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨,Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±,Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„,Ø³Ø¨Ø¨ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±,ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„\n";
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                
                bookings.forEach(booking => {
                    csvContent += `"Ø­Ø¬Ø²","${dayInfo.name}","${dayInfo.date}","${booking.studentName}","${booking.parentName}","${booking.phoneNumber}","","${booking.timestamp}"\n`;
                });
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª
            if (bookingsData.excuses && bookingsData.excuses.length > 0) {
                bookingsData.excuses.forEach(excuse => {
                    csvContent += `"Ø§Ø¹ØªØ°Ø§Ø±","","","${excuse.studentName}","${excuse.parentName}","${excuse.phoneNumber}","${excuse.excuseReason}","${excuse.timestamp}"\n`;
                });
            }
            
            const blob = new Blob(["\ufeff" + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `Ø§Ø¬ØªÙ…Ø§Ø¹_Ø£ÙˆÙ„ÙŠØ§Ø¡_Ø§Ù„Ø£Ù…ÙˆØ±_Ø´Ø§Ù…Ù„_${new Date().toLocaleDateString('ar-SA')}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        function printReport() {
            const printWindow = window.open('', '_blank');
            const printContent = generatePrintContent();
            
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => printWindow.print(), 500);
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
        function generatePrintContent() {
            return `
                <!DOCTYPE html>
                <html lang="ar" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <title>ØªÙ‚Ø±ÙŠØ± Ø§Ø¬ØªÙ…Ø§Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</title>
                    <style>
                        body { font-family: Arial; padding: 20px; direction: rtl; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .title { color: #0d5c0d; font-size: 24px; font-weight: bold; }
                        .subtitle { color: #666; margin: 10px 0; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
                        th { background: #0d5c0d; color: white; }
                        tr:nth-child(even) { background: #f9f9f9; }
                        .summary { background: #f0f0f0; padding: 15px; margin: 20px 0; border-radius: 5px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1 class="title">ØªÙ‚Ø±ÙŠØ± Ø§Ø¬ØªÙ…Ø§Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</h1>
                        <p class="subtitle">Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ - Ù…ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹ÙˆØ§Ù„ÙŠ</p>
                        <p class="subtitle">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: Ø®Ø§Ù„Ø¯ Ø³Ø¹ÙˆØ¯ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</p>
                        <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-SA')}</p>
                    </div>
                    
                    <div class="summary">
                        <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:</h3>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª: ${getTotalBookings()}</p>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª: ${bookingsData.excuses ? bookingsData.excuses.length : 0}</p>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯: ${getTotalCapacity()}</p>
                        <p>Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªØ§Ø­Ø©: ${getTotalAvailable()}</p>
                        <p>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ø´ØºØ§Ù„: ${getOccupancyRate()}%</p>
                    </div>
                    
                    ${generatePrintTable()}
                </body>
                </html>
            `;
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
        function generatePrintTable() {
            let tableHTML = '';
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                
                if (bookings.length > 0) {
                    tableHTML += `
                        <h3 style="color: #0d5c0d; margin-top: 30px;">
                            ${dayInfo.name} - ${dayInfo.date} (${bookings.length}/${dayInfo.max})
                        </h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                    <th>Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</th>
                                    <th>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</th>
                                    <th>ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    bookings.forEach((booking, index) => {
                        tableHTML += `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${booking.studentName}</td>
                                <td>${booking.parentName}</td>
                                <td>${booking.phoneNumber}</td>
                                <td style="font-size: 11px;">${booking.timestamp}</td>
                            </tr>
                        `;
                    });
                    
                    tableHTML += '</tbody></table>';
                } else {
                    tableHTML += `
                        <h3 style="color: #0d5c0d; margin-top: 30px;">
                            ${dayInfo.name} - ${dayInfo.date} (0/${dayInfo.max})
                        </h3>
                        <p style="text-align: center; color: #999; font-style: italic; padding: 20px; border: 1px dashed #ccc;">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
                        </p>
                    `;
                }
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª
            const excuses = bookingsData.excuses || [];
            if (excuses.length > 0) {
                tableHTML += `
                    <h3 style="color: #856404; margin-top: 40px; background: #fff3cd; padding: 10px; border-radius: 5px;">
                        ğŸ˜” Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±Ø§Øª (${excuses.length})
                    </h3>
                    <table style="border: 2px solid #ffc107;">
                        <thead>
                            <tr style="background: #ffc107; color: #000;">
                                <th>#</th>
                                <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                <th>Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</th>
                                <th>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</th>
                                <th>Ø³Ø¨Ø¨ Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø±</th>
                                <th>ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                excuses.forEach((excuse, index) => {
                    tableHTML += `
                        <tr style="background: ${index % 2 === 0 ? '#fff3cd' : 'white'};">
                            <td>${index + 1}</td>
                            <td>${excuse.studentName}</td>
                            <td>${excuse.parentName}</td>
                            <td>${excuse.phoneNumber}</td>
                            <td style="font-size: 11px; max-width: 150px; word-wrap: break-word;">${excuse.excuseReason}</td>
                            <td style="font-size: 10px;">${excuse.timestamp}</td>
                        </tr>
                    `;
                });
                
                tableHTML += '</tbody></table>';
            }
            
            return tableHTML;
        }
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function resetAllData() {
            const confirmMessage = 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¬ÙˆØ²Ø§ØªØŸ\n\nØªØ­Ø°ÙŠØ±: Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡!';
            
            if (confirm(confirmMessage)) {
                const doubleConfirm = 'ØªØ£ÙƒÙŠØ¯ Ø£Ø®ÙŠØ±: Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹.\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ';
                
                if (confirm(doubleConfirm)) {
                    localStorage.removeItem('parentMeetingBookings');
                    bookingsData = {};
                    updateStatistics();
                    createDaysOverview();
                    
                    alert('âœ… ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                }
            }
        }
        
        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function getTotalBookings() {
            let total = 0;
            for (const dayKey in DAYS_DATA) {
                const bookings = bookingsData[dayKey] || [];
                total += bookings.length;
            }
            return total;
        }
        
        function getTotalCapacity() {
            let total = 0;
            for (const dayKey in DAYS_DATA) {
                total += DAYS_DATA[dayKey].max;
            }
            return total;
        }
        
        function getTotalAvailable() {
            return getTotalCapacity() - getTotalBookings();
        }
        
        function getOccupancyRate() {
            const total = getTotalBookings();
            const capacity = getTotalCapacity();
            return capacity > 0 ? Math.round((total / capacity) * 100) : 0;
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ© (ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ Ø­Ø¬ÙˆØ²Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©)
        function autoRefresh() {
            const newData = JSON.parse(localStorage.getItem('parentMeetingBookings') || '{}');
            
            // Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
            if (JSON.stringify(newData) !== JSON.stringify(bookingsData)) {
                bookingsData = newData;
                updateStatistics();
                createDaysOverview();
                
                // Ø¥Ø¸Ù‡Ø§Ø± ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ù…Ø¯ÙŠØ±
                showNotification('ğŸ“¬ ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯!');
            }
        }
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø¯ÙŠØ±
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #28a745, #20c997);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 9999;
                font-size: 16px;
                font-weight: bold;
                animation: slideIn 0.5s ease;
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†Ù
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.5s ease';
                setTimeout(() => document.body.removeChild(notification), 500);
            }, 5000);
        }
        
        // Ø¥Ø¶Ø§ÙØ© CSS Ù„Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
        const animationCSS = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        
        const styleSheet = document.createElement('style');
        styleSheet.textContent = animationCSS;
        document.head.appendChild(styleSheet);
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¨Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        document.getElementById('reportModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Ù…Ø¹Ø§Ù„Ø¬ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
        
        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹ (ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹)
        function searchBookings(query) {
            const results = [];
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                
                bookings.forEach(booking => {
                    if (booking.studentName.includes(query) || 
                        booking.parentName.includes(query) || 
                        booking.phoneNumber.includes(query)) {
                        results.push({
                            ...booking,
                            day: dayInfo.name,
                            date: dayInfo.date
                        });
                    }
                });
            }
            
            return results;
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ
        function generateDailyReport(dayKey) {
            const dayInfo = DAYS_DATA[dayKey];
            const bookings = bookingsData[dayKey] || [];
            
            return {
                day: dayInfo.name,
                date: dayInfo.date,
                totalBookings: bookings.length,
                maxCapacity: dayInfo.max,
                availableSlots: dayInfo.max - bookings.length,
                occupancyRate: Math.round((bookings.length / dayInfo.max) * 100),
                bookings: bookings
            };
        }
        
        // ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯
        function exportDayReport(dayKey) {
            const report = generateDailyReport(dayKey);
            const dayInfo = DAYS_DATA[dayKey];
            
            let csvContent = `ØªÙ‚Ø±ÙŠØ± ${dayInfo.name} - ${dayInfo.date}\n`;
            csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª: ${report.totalBookings}\n`;
            csvContent += `Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªØ§Ø­Ø©: ${report.availableSlots}\n`;
            csvContent += `Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ø´ØºØ§Ù„: ${report.occupancyRate}%\n\n`;
            csvContent += "Ø§Ù„Ø±Ù‚Ù…,Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨,Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±,Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„,ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„\n";
            
            report.bookings.forEach((booking, index) => {
                csvContent += `"${index + 1}","${booking.studentName}","${booking.parentName}","${booking.phoneNumber}","${booking.timestamp}"\n`;
            });
            
            const blob = new Blob(["\ufeff" + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `${dayInfo.name}_${dayInfo.date}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // ØªØ´ØºÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        document.addEventListener('DOMContentLoaded', function() {
            updateStatistics();
            createDaysOverview();
            
            // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
            setInterval(autoRefresh, 30000);
            
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ØµØ±ÙŠØ© Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.animation = 'slideInUp 0.6s ease forwards';
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(30px)';
                    
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, 100);
                }, index * 100);
            });
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ø±Ø³ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ© Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
        const cardAnimationCSS = `
            @keyframes slideInUp {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        
        const cardStyleSheet = document.createElement('style');
        cardStyleSheet.textContent = cardAnimationCSS;
        document.head.appendChild(cardStyleSheet);
        
        // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
        window.addEventListener('storage', function(e) {
            if (e.key === 'parentMeetingBookings') {
                bookingsData = JSON.parse(e.newValue || '{}');
                updateStatistics();
                createDaysOverview();
                showNotification('ğŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹');
            }
        });
    </script>
</body>
</html>
